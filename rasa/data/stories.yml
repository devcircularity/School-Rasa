version: "3.1"

stories:

# ============================================
# STUDENT MANAGEMENT STORIES
# ============================================

- story: Student creation simple
  steps:
  - intent: create_student
  - action: action_create_student

- story: Student creation with details
  steps:
  - intent: create_student
    entities:
    - student_name: "John Doe"
    - admission_no: "123"
    - class_name: "Grade 5"
  - action: action_create_student

- story: List students
  steps:
  - intent: list_students
  - action: action_list_students

- story: Search student
  steps:
  - intent: search_student
    entities:
    - student_query: "Eric"
  - action: action_search_student

- story: Get student details
  steps:
  - intent: get_student_details
    entities:
    - student_name: "John Doe"
  - action: action_get_student_details

- story: Show unassigned students
  steps:
  - intent: show_unassigned_students
  - action: action_show_unassigned_students

- story: Reenroll student
  steps:
  - intent: reenroll_student
    entities:
      - student_name: "Eric Mwirichia"
      - class_name: "8A"
  - action: action_reenroll_student

- story: List students by class
  steps:
  - intent: list_students_by_class
    entities:
    - class_name: "Grade 5"
  - action: action_list_students_by_class

# ============================================
# GUARDIAN MANAGEMENT STORIES
# ============================================

- story: Add guardian simple
  steps:
  - intent: add_guardian
  - action: action_add_guardian

- story: Add guardian with complete info
  steps:
  - intent: add_guardian
    entities:
    - guardian_name: "Mary Wanjiku"
    - relationship: "mother"
    - student_name: "Eric"
    - phone: "0712345678"
    - email: "mary@gmail.com"
  - action: action_add_guardian

- story: Get guardians
  steps:
  - intent: get_guardians
    entities:
    - student_name: "Eric"
  - action: action_get_guardians

- story: List students without guardians
  steps:
  - intent: list_students_without_guardians
  - action: action_list_students_without_guardians

- story: Set primary guardian
  steps:
  - intent: set_primary_guardian
    entities:
    - guardian_name: "Mary Wanjiku"
    - admission_no: "2345"
  - action: action_set_primary_guardian

- story: Update guardian
  steps:
  - intent: update_guardian
    entities:
    - guardian_name: "Eric Mwirichia"
    - email: "eric@gmail.com"
  - action: action_update_guardian

# ============================================
# GREETING AND HELP
# ============================================

- story: Simple greeting
  steps:
  - intent: greet
  - action: utter_greet

- story: Greet and ask for help
  steps:
  - intent: greet
  - action: utter_greet
  - intent: ask_help
  - action: action_help

- story: Bot challenge
  steps:
  - intent: bot_challenge
  - action: utter_iamabot

- story: Ask for help directly
  steps:
  - intent: ask_help
  - action: action_help

- story: Goodbye
  steps:
  - intent: goodbye
  - action: utter_goodbye

# ============================================
# ACADEMIC SETUP WORKFLOWS
# ============================================

- story: Academic setup check
  steps:
  - intent: check_academic_setup
  - action: action_check_academic_setup

- story: Full academic setup workflow
  steps:
  - intent: create_academic_year
    entities:
    - academic_year: "2025"
  - action: action_create_academic_year
  - intent: create_academic_term
    entities:
    - term: "1"
  - action: action_create_academic_term
  - intent: check_academic_setup
  - action: action_check_academic_setup

- story: Create class after setup
  steps:
  - intent: check_academic_setup
  - action: action_check_academic_setup
  - intent: create_class
    entities:
    - level: "8"
  - action: action_create_class

- story: Academic year activation workflow
  steps:
  - intent: check_academic_setup
  - action: action_check_academic_setup
  - intent: activate_academic_year
    entities:
    - academic_year: "2025"
  - action: action_activate_academic_year
  - intent: create_academic_term
    entities:
    - term: "1"
  - action: action_create_academic_term

- story: Student promotion workflow
  steps:
  - intent: promote_students
    entities:
    - target_term: "2"
  - action: action_promote_students
  - intent: check_academic_setup
  - action: action_check_academic_setup

- story: Term transition workflow
  steps:
  - intent: check_academic_setup
  - action: action_check_academic_setup
  - intent: create_academic_term
    entities:
    - term: "2"
  - action: action_create_academic_term
  - intent: promote_students
    entities:
    - target_term: "2"
  - action: action_promote_students

- story: Academic year management flow
  steps:
  - intent: get_current_academic_year
  - action: action_get_current_academic_year
  - intent: activate_academic_year
    entities:
    - academic_year: "2025"
  - action: action_activate_academic_year
  - intent: create_academic_term
    entities:
    - term: "1"
  - action: action_create_academic_term
  - intent: promote_students
    entities:
    - target_term: "1"
  - action: action_promote_students

- story: List academic terms workflow
  steps:
  - intent: check_academic_setup
  - action: action_check_academic_setup
  - intent: list_academic_terms
  - action: action_list_academic_terms
  - intent: activate_term
    entities:
      - term: "3"
  - action: action_activate_term

- story: Term activation and student promotion
  steps:
  - intent: activate_term
    entities:
      - term: "2"
  - action: action_activate_term
  - intent: promote_students
    entities:
      - target_term: "2"
  - action: action_promote_students

- story: Create term for new academic year
  steps:
  - intent: create_academic_term
    entities:
      - term: "3"
      - academic_year: "2025"
  - action: action_create_academic_term
  - intent: activate_academic_year
    entities:
      - academic_year: "2025"
  - action: action_activate_academic_year

- story: Complete term
  steps:
  - intent: complete_term
    entities:
    - term: "1"
  - action: action_complete_term

# ============================================
# CLASS MANAGEMENT WORKFLOWS
# ============================================

- story: Class management workflow
  steps:
  - intent: create_class
    entities:
    - level: "8"
  - action: action_create_class
  - intent: list_classes
  - action: action_list_classes
  - intent: list_empty_classes
  - action: action_list_empty_classes
  - intent: goodbye
  - action: utter_goodbye

- story: Class analysis workflow
  steps:
  - intent: list_classes
  - action: action_list_classes
  - intent: list_students_by_class
    entities:
    - class_name: "Grade 5"
  - action: action_list_students_by_class
  - intent: list_empty_classes
  - action: action_list_empty_classes

- story: Delete class workflow
  steps:
  - intent: list_classes
  - action: action_list_classes
  - intent: delete_class
    entities:
      - class_name: "8A"
  - action: action_delete_class
  - intent: list_classes
  - action: action_list_classes

- story: Add stream to class
  steps:
  - intent: add_stream_to_class
    entities:
    - stream: "Red"
    - class_name: "8"
  - action: action_add_stream_to_class

- story: List streams for class
  steps:
  - intent: list_streams
    entities:
    - class_name: "8"
  - action: action_list_streams

- story: Rename class
  steps:
  - intent: rename_class
    entities:
    - class_name: "8A"
    - name: "8 Red"
  - action: action_rename_class

# ============================================
# FEE MANAGEMENT WORKFLOWS
# ============================================

- story: Publish fee structure and set as default
  steps:
  - intent: publish_fee_structure
    entities:
      - structure_name: "Term 3 2025"
  - action: action_publish_fee_structure
  - slot_was_set:
    - pending_default_structure_id: "some-uuid"
  - intent: affirm_set_default
  - action: action_set_default_fee_structure

- story: Publish fee structure but skip default
  steps:
  - intent: publish_fee_structure
    entities:
      - structure_name: "Term 3 2025"
  - action: action_publish_fee_structure
  - slot_was_set:
    - pending_default_structure_id: "some-uuid"
  - intent: deny_set_default
  - action: utter_acknowledged

- story: Set existing structure as default
  steps:
  - intent: set_structure_as_default
    entities:
      - structure_name: "Term 3 2025"
  - action: action_set_structure_as_default

- story: Generate invoices with no default set
  steps:
  - intent: generate_invoices
    entities:
      - academic_year: "2025"
      - term: "3"
  - action: action_generate_invoices
  - intent: set_structure_as_default
    entities:
      - structure_name: "Term 3 2025"
  - action: action_set_structure_as_default
  - intent: generate_invoices
    entities:
      - academic_year: "2025"
      - term: "3"
  - action: action_generate_invoices

- story: Fee structure creation and publishing
  steps:
  - intent: create_fee_structure
    entities:
      - academic_year: "2025"
      - term: "3"
  - action: action_create_fee_structure
  - intent: add_fee_item
    entities:
      - fee_type: "tuition"
      - amount: "25000"
  - action: action_add_fee_item
  - intent: publish_fee_structure
    entities:
      - term: "3"
      - academic_year: "2025"
  - action: action_publish_fee_structure
  - intent: affirm_set_default
  - action: action_set_default_fee_structure

- story: View and delete fee items
  steps:
  - intent: view_fee_structure_details
    entities:
      - structure_name: "Term 3 2025"
  - action: action_view_fee_structure_details
  - intent: delete_specific_fee_item
    entities:
      - fee_type: "transport"
      - structure_name: "Term 3 2025"
  - action: action_delete_specific_fee_item

- story: Complete fee management workflow
  steps:
  - intent: list_fee_structures
  - action: action_list_fee_structures
  - intent: view_fee_structure_details
    entities:
      - structure_name: "Term 3 2025"
  - action: action_view_fee_structure_details
  - intent: add_fee_item
    entities:
      - fee_type: "lunch"
      - amount: "3000"
  - action: action_add_fee_item
  - intent: publish_fee_structure
    entities:
      - structure_name: "Term 3 2025"
  - action: action_publish_fee_structure

# ============================================
# INVOICE WORKFLOWS
# ============================================

- story: Invoice generation workflow
  steps:
  - intent: list_fee_structures
  - action: action_list_fee_structures
  - intent: generate_invoices
    entities:
      - academic_year: "2025"
      - term: "3"
  - action: action_generate_invoices
  - intent: get_invoice
    entities:
    - student_name: "Eric"
  - action: action_get_invoice

- story: Complete invoice workflow
  steps:
  - intent: generate_invoices
    entities:
      - academic_year: "2025"
      - term: "3"
  - action: action_generate_invoices
  - intent: issue_invoices
    entities:
      - academic_year: "2025"
      - term: "3"
  - action: action_issue_invoices

- story: Review before issuing
  steps:
  - intent: generate_invoices
    entities:
      - academic_year: "2025"
      - term: "3"
  - action: action_generate_invoices
  - intent: get_invoice
    entities:
      - student_name: "Eric"
  - action: action_get_invoice
  - intent: issue_invoices
    entities:
      - academic_year: "2025"
      - term: "3"
  - action: action_issue_invoices

- story: Class-specific invoice issuing
  steps:
  - intent: issue_invoices
    entities:
      - class_name: "Grade 4"
      - academic_year: "2025"
      - term: "3"
  - action: action_issue_invoices

- story: List unpaid invoices
  steps:
  - intent: list_unpaid_invoices
    entities:
    - academic_year: "2025"
    - term: "3"
  - action: action_list_unpaid_invoices

- story: Cancel invoice
  steps:
  - intent: cancel_invoice
    entities:
    - student_name: "Eric"
  - action: action_cancel_invoice

# ============================================
# PAYMENT WORKFLOWS
# ============================================

- story: Record payment and send notification
  steps:
  - intent: record_payment
    entities:
    - amount: "25000"
    - student_name: "Brian"
    - admission_no: "7777"
    - payment_method: "MPESA"
  - action: action_record_payment
  - slot_was_set:
    - pending_payment_notification: "yes"
  - intent: affirm_send_payment_notification
  - action: action_send_payment_notification
  - action: action_reset_slots

- story: Record payment and skip notification
  steps:
  - intent: record_payment
    entities:
    - amount: "10000"
    - admission_no: "5555"
    - payment_method: "cash"
  - action: action_record_payment
  - slot_was_set:
    - pending_payment_notification: "yes"
  - intent: deny_send_payment_notification
  - action: action_reset_slots

# ============================================
# NOTIFICATION WORKFLOWS
# ============================================

- story: Notify pending invoices
  steps:
  - intent: notify_pending_invoices
    entities:
    - academic_year: "2025"
    - term: "3"
  - action: action_notify_pending_invoices

- story: Send guardian message
  steps:
  - intent: send_guardian_message
    entities:
    - student_name: "Eric"
    - message: "coming to school this friday"
  - action: action_send_guardian_message

- story: Notify parents with balances
  steps:
  - intent: notify_parents_with_balances
    entities:
    - academic_year: "2025"
    - term: "3"
  - action: action_notify_parents_with_balances

- story: Broadcast message to all parents
  steps:
  - intent: broadcast_message_to_all_parents
    entities:
    - message: "come for a meeting tomorrow"
  - action: action_broadcast_message_to_all_parents

# ============================================
# SCHOOL INFO
# ============================================

- story: Get school information
  steps:
  - intent: get_school_info
  - action: action_get_school_info